<!DOCTYPE html>
<html lang="ru">
<head>
    <style>
        :root {
            --bg-color: #121212;
            --card-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --accent-gold: #FFD700;
            --call-color: #2196F3;
            --put-color: #f44336;
            --call-color-light: #4caf50;
            --put-color-light: #ff9800;
            --strike-bg: #2c2c2c;
            --bullish: #4caf50;
            --bearish: #f44336;
            --neutral: #9e9e9e;
        }
        
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg-color); color: var(--text-color); }
        a { text-decoration: none; color: inherit; }
        
        .chart-box, .analytics-card {
            position: relative;
            overflow: visible !important;
            z-index: 1;
        }

        .chart-title, .analytics-title {
            display: flex; justify-content: center; align-items: center; flex-wrap: wrap;
            position: relative; z-index: 10;
            font-size: 1.1em; font-weight: bold; color: var(--accent-gold);
            margin-bottom: 15px; text-align: center;
        }

        .chart-help, .analytics-help {
            position: relative; display: inline-block; cursor: help;
            margin-left: 8px; font-size: 1.1em; color: var(--accent-gold); z-index: 20;
        }

        .chart-annotation, .analytics-annotation {
            visibility: hidden; opacity: 0;
            position: absolute; bottom: 140%; left: 50%; transform: translateX(-50%);
            width: 260px; background: rgba(15, 15, 15, 0.98);
            border: 1px solid var(--accent-gold); box-shadow: 0 5px 20px rgba(0,0,0,0.8);
            border-radius: 8px; padding: 12px 15px;
            color: #eee; font-size: 0.85rem; font-weight: normal; line-height: 1.4;
            text-align: left; white-space: normal;
            transition: all 0.2s ease-in-out; pointer-events: none; z-index: 99999;
        }

        .chart-annotation::after, .analytics-annotation::after {
            content: ''; position: absolute; top: 100%; left: 50%; margin-left: -6px;
            border-width: 6px; border-style: solid;
            border-color: var(--accent-gold) transparent transparent transparent;
        }
        
        .chart-annotation strong, .analytics-annotation strong { color: var(--accent-gold); font-weight: bold; }

        .chart-help:hover .chart-annotation, 
        .analytics-help:hover .analytics-annotation {
            visibility: visible; opacity: 1; bottom: 125%;
        }

        header { background: #333; padding: 10px 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .logo { font-size: 1.5em; font-weight: bold; color: #fff; display: flex; align-items: center; gap: 10px; }
        .menu { list-style: none; display: flex; gap: 20px; padding: 0; margin: 0; }
        .menu a:hover { color: var(--accent-gold); }
        .tg-link-small { background: #24A1DE; padding: 5px 12px; border-radius: 15px; display: flex; align-items: center; gap: 5px; font-size: 0.8em; color: white; }
        .tg-link-small:hover { background: #1d8cbd; transform: translateY(-1px); }

        .hero { background: linear-gradient(135deg, #000000 0%, #434343 100%); padding: 40px 20px; text-align: center; color: #fff; }
        .hero h1 { margin: 0 0 5px 0; font-size: 2em; font-weight: 800; color: var(--accent-gold); }
        .subtitle { font-size: 1.1em; margin-bottom: 20px; opacity: 0.8; }
        .hero-buttons { display: flex; justify-content: center; gap: 15px; flex-wrap: wrap; margin-top: 20px; }
        .btn { padding: 12px 25px; border-radius: 25px; font-weight: bold; transition: 0.3s; display: inline-flex; align-items: center; gap: 10px; border: none; cursor: pointer; text-decoration: none; }
        .btn-primary { background: var(--accent-gold); color: #000; }
        .btn-primary:hover { background: #fff; }
        .btn-telegram { background: #24A1DE; color: white; }
        .btn-telegram:hover { background: #1d8cbd; transform: translateY(-2px); }

        .live-data { padding: 20px; background: #000; }
        .warning-block { text-align: center; margin-bottom: 20px; border: 1px solid #b71c1c; background: rgba(183, 28, 28, 0.1); padding: 15px; border-radius: 8px; }
        .warning-title { color: #e57373; font-size: 1em; font-weight: bold; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 5px; }
        .warning-text { color: #ccc; font-size: 0.9em; margin: 0; }

        .alerts-container { max-width: 1200px; margin: 0 auto 20px auto; display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
        .alert { padding: 12px 20px; border-radius: 8px; font-weight: bold; font-size: 0.9em; border-left: 4px solid; animation: slideIn 0.3s ease; }
        @keyframes slideIn { from { transform: translateY(-20px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .alert-warning { background: rgba(255, 152, 0, 0.1); border-color: #ff9800; color: #ffb74d; }
        .alert-danger { background: rgba(244, 67, 54, 0.1); border-color: #f44336; color: #ef5350; }
        .alert-info { background: rgba(33, 150, 243, 0.1); border-color: #2196f3; color: #42a5f5; }
        .alert-success { background: rgba(76, 175, 80, 0.1); border-color: #4caf50; color: #66bb6a; }

        .data-container { display: flex; justify-content: center; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
        .data-card { background: #222; padding: 10px; border-radius: 8px; min-width: 140px; text-align: center; border: 1px solid #333; }
        .big-number { font-size: 1.3em; font-weight: bold; color: var(--accent-gold); margin: 5px 0; }
        .small-text { color: #888; font-size: 0.75em; }
        .pcr-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 5px; }
        .pcr-item div:first-child { font-weight: bold; color: #fff; }
        .pcr-item div:last-child { font-size: 0.7em; color: #888; }

        .analytics-grid { max-width: 1200px; margin: 0 auto 20px auto; display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; }
        .analytics-card { background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%); border: 1px solid #444; border-radius: 10px; padding: 20px; }
        .analytics-card::before { content: ''; position: absolute; top: 0; left: 0; width: 4px; height: 100%; background: var(--accent-gold); border-top-left-radius: 10px; border-bottom-left-radius: 10px; }
        .analytics-value { font-size: 2em; font-weight: bold; color: #fff; text-align: center; margin: 10px 0; text-shadow: 0 0 10px rgba(255,255,255,0.1); }
        .analytics-label { color: #888; font-size: 0.85em; text-align: center; }

        .level-item { background: #222; padding: 8px 12px; border-radius: 6px; margin: 5px 0; display: flex; justify-content: space-between; align-items: center; border-left: 3px solid transparent; }
        .level-item.support { border-left-color: var(--put-color); }
        .level-item.resistance { border-left-color: var(--call-color); }
        .level-strike { font-weight: bold; color: #fff; }

        .charts-container { max-width: 1200px; margin: 0 auto 30px auto; display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        .chart-box { background: #1a1a1a; border: 1px solid #444; padding: 20px; border-radius: 10px; }
        .chart-wrapper { position: relative; height: 300px; }

        .sentiment-badge { display: inline-block; padding: 5px 15px; border-radius: 20px; font-weight: bold; font-size: 0.9em; text-transform: uppercase; }
        .sentiment-bullish { background: var(--bullish); color: #fff; }
        .sentiment-bearish { background: var(--bearish); color: #fff; }
        .sentiment-neutral { background: var(--neutral); color: #fff; }

        .risk-indicator { display: flex; align-items: center; justify-content: center; gap: 10px; margin-top: 10px; }
        .risk-bar { width: 100%; height: 20px; background: #333; border-radius: 10px; overflow: hidden; position: relative; }
        .risk-fill { height: 100%; transition: width 0.5s ease; border-radius: 10px; }
        .risk-low { background: var(--bullish); }
        .risk-medium { background: #ff9800; }
        .risk-high { background: var(--bearish); }

        .control-panel { max-width: 1000px; margin: 0 auto 20px auto; background: #1a1a1a; border: 1px solid #444; padding: 20px; border-radius: 10px; display: flex; flex-direction: column; gap: 15px; }
        .expiry-toggle, .calculator-panel, .strike-filter { display: flex; align-items: center; justify-content: center; gap: 10px; flex-wrap: wrap; }
        .expiry-toggle { background: #2a2a2a; padding: 15px; border: 1px solid var(--accent-gold); border-radius: 8px; }
        .calculator-panel { background: #2a2a2a; border: 1px solid var(--accent-gold); padding: 15px; border-radius: 8px; }
        
        button { cursor: pointer; }
        .expiry-btn, .filter-btn { background: #333; color: #aaa; border: 1px solid #555; padding: 8px 16px; border-radius: 5px; transition: all 0.3s; }
        .expiry-btn:hover, .filter-btn:hover { background: #444; }
        .expiry-btn.active, .filter-btn.active { background: var(--accent-gold); color: #000; border-color: var(--accent-gold); font-weight: bold; }
        .calc-input { background: #111; border: 1px solid #555; color: var(--accent-gold); padding: 10px; border-radius: 5px; width: 100px; font-size: 1.2em; text-align: center; font-weight: bold; }
        .premium-btn { background: #d32f2f; color: white; padding: 10px 20px; border: none; border-radius: 5px; font-weight: bold; transition: all 0.3s; }
        .premium-btn:hover { background: #f44336; }
        .premium-btn.active { background: #4caf50; }

        .top5-container { max-width: 1000px; margin: 0 auto 20px auto; display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .top5-box { background: #1a1a1a; border: 1px solid #444; padding: 15px; border-radius: 10px; }
        .top5-title { font-size: 1.1em; font-weight: bold; color: var(--accent-gold); margin-bottom: 10px; text-align: center; border-bottom: 2px solid #333; padding-bottom: 8px; }
        .top5-item { background: #222; padding: 8px 12px; border-radius: 6px; display: flex; justify-content: space-between; align-items: center; border-left: 3px solid transparent; margin-bottom: 5px; }
        .top5-item.call-item { border-left-color: var(--call-color); }
        .top5-item.put-item { border-left-color: var(--put-color); }
        .top5-strike { font-weight: bold; color: #fff; font-size: 1.1em; min-width: 70px; }
        .top5-value { color: var(--accent-gold); font-weight: bold; font-size: 1em; }

        .levels-container { max-width: 1000px; margin: 0 auto; background: #1a1a1a; border-radius: 8px; overflow: hidden; border: 1px solid #333; }
        .table-header-info { background: #2c2c2c; padding: 8px 20px; text-align: center; color: #fff; font-size: 0.9em; border-bottom: 1px solid #444; display: flex; justify-content: space-between; }
        .dte-tag { background: #d32f2f; color: white; padding: 2px 6px; border-radius: 4px; font-size: 0.8em; }
        .table-wrapper { overflow-x: auto; max-height: 600px; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; text-align: center; font-size: 0.85em; }
        thead { background: #111; color: #aaa; font-size: 0.9em; position: sticky; top: 0; z-index: 5; }
        th { padding: 8px 4px; font-weight: 600; white-space: nowrap; }
        td { padding: 6px 4px; border-bottom: 1px solid #2a2a2a; } 
        .col-strike { background: #252525; color: #fff; font-weight: bold; font-size: 1.1em; border-left: 1px solid #333; border-right: 1px solid #333; width: 80px; }
        .row-atm td { background: rgba(255, 215, 0, 0.1); border-top: 1px solid var(--accent-gold); border-bottom: 1px solid var(--accent-gold); }
        .forward-active { color: var(--accent-gold) !important; text-decoration: underline; }

        .val-0 { color: #333; } .val-1 { color: #666; } .val-2 { color: #999; } .val-3 { color: #ccc; font-weight: 500; }
        .val-4 { color: #fff; font-weight: bold; } .val-5 { color: #4fc3f7; font-weight: bold; font-size: 1.05em; }
        .val-6 { color: #FFD700; font-weight: bold; font-size: 1.1em; text-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }
        .val-7 { background: #b71c1c; color: #fff; font-weight: bold; padding: 4px; border-radius: 4px; }

        .download { padding: 40px 20px; text-align: center; }
        .download-card { background: #222; padding: 30px; display:inline-block; border-radius:10px; border:1px solid #333; }
        .btn-download { background: var(--call-color); color: white; padding: 15px 30px; border-radius: 5px; display: inline-block; margin: 10px 0; font-weight: bold; }
        .disclaimer-link { background: #333; color: var(--accent-gold); padding: 10px 20px; border-radius: 5px; display: inline-block; margin: 10px; cursor: pointer; font-weight: bold; }
        .disclaimer-link:hover { background: #444; }

        .security-info { max-width: 800px; margin: 0 auto 3rem auto; text-align: left; }
        .security-card { background: linear-gradient(135deg, #1a472a 0%, #2d5a3d 100%); border: 2px solid #4caf50; border-radius: 15px; padding: 2rem; color: #fff; box-shadow: 0 10px 30px rgba(76, 175, 80, 0.3); }
        .security-icon { font-size: 3rem; text-align: center; margin-bottom: 1rem; }
        .security-card h3 { color: #81c784; text-align: center; margin-bottom: 1rem; font-size: 1.5rem; }
        .install-guide { background: rgba(0, 0, 0, 0.2); border-radius: 8px; padding: 1rem; margin-top: 1.5rem; cursor: pointer; }
        .install-guide summary { font-weight: bold; color: #81c784; outline: none; }

        .disclaimer-modal { display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); overflow: auto; }
        .disclaimer-content { background: #1a1a1a; margin: 5% auto; padding: 30px; border: 2px solid var(--accent-gold); border-radius: 10px; width: 90%; max-width: 700px; color: #fff; }
        .close-disclaimer { background: var(--accent-gold); color: #000; padding: 10px 30px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; float: right; }
        .close-disclaimer:hover { background: #fff; }

        footer { background: #111; padding: 20px; text-align: center; color: #666; font-size: 0.8em; }

        @media (max-width: 768px) {
            .menu { display: none; }
            .hero h1 { font-size: 1.8em; }
            .calculator-panel, .strike-filter, .expiry-toggle { flex-direction: column; }
            .top5-container, .analytics-grid, .charts-container { grid-template-columns: 1fr; }
            .chart-annotation, .analytics-annotation { width: 250px; left: 50%; bottom: 150%; }
        }
    </style>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="description" content="–û–ø—Ü–∏–æ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ Gold (CME). Max Pain, Gamma Walls, Greeks Analytics, Real-time Charts.">
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìä</text></svg>">

    <title>Gold Options - Pro Analytics</title>
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
</head>
<body>

    <header>
        <div class="logo"><span>üìä</span> Gold Options</div>
        <nav>
            <ul class="menu">
                <li><a href="#analytics">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</a></li>
                <li><a href="#charts">–ì—Ä–∞—Ñ–∏–∫–∏</a></li>
                <li><a href="#greeks">Greeks</a></li>
                <li><a href="#top5">–¢–û–ü-5</a></li>
                <li><a href="#download">APK</a></li>
                <li class="tg-menu-item">
                    <a href="https://t.me/+-tmtq_FUl2NhMjVi" target="_blank" class="tg-link-small">
                        <svg viewBox="0 0 24 24" width="18" height="18"><path fill="currentColor" d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.891 8.146l-1.703 8.026c-.128.564-.463.702-.937.437l-2.592-1.911-1.251 1.203c-.138.138-.254.254-.518.254l.186-2.637 4.8-4.336c.209-.186-.045-.289-.323-.104l-5.932 3.735-2.556-.799c-.555-.174-.567-.555.116-.822l9.989-3.85c.463-.174.867.104.721.799z"/></svg>
                        Telegram
                    </a>
                </li>
            </ul>
        </nav>
    </header>

    <section class="hero">
        <h1>Gold Analytics Pro</h1>
        <p class="subtitle">Max Pain ‚Ä¢ Gamma Walls ‚Ä¢ Greeks Analytics ‚Ä¢ Real-time Data</p>
        
        <div class="hero-buttons">
            <a href="#download" class="btn btn-primary">–°–∫–∞—á–∞—Ç—å Android APK</a>
            
            <a href="https://t.me/+-tmtq_FUl2NhMjVi" target="_blank" class="btn btn-telegram">
                <svg viewBox="0 0 24 24" width="22" height="22"><path fill="currentColor" d="M12 0c-6.627 0-12 5.373-12 12s5.373 12 12 12 12-5.373 12-12-5.373-12-12-12zm5.891 8.146l-1.703 8.026c-.128.564-.463.702-.937.437l-2.592-1.911-1.251 1.203c-.138.138-.254.254-.518.254l.186-2.637 4.8-4.336c.209-.186-.045-.289-.323-.104l-5.932 3.735-2.556-.799c-.555-.174-.567-.555.116-.822l9.989-3.85c.463-.174.867.104.721.799z"/></svg>
                –ù–∞—à –∫–∞–Ω–∞–ª
            </a>
        </div>
    </section>

    <!-- DISCLAIMER MODAL -->
    <div id="disclaimerModal" class="disclaimer-modal">
        <div class="disclaimer-content">
            <h2>‚ö†Ô∏è –û–¢–ö–ê–ó –û–¢ –û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–ò</h2>
            
            <p><strong>–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π —Ö–∞—Ä–∞–∫—Ç–µ—Ä:</strong><br>
            –í—Å–µ –¥–∞–Ω–Ω—ã–µ, –≥—Ä–∞—Ñ–∏–∫–∏, –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ —Ä–∞—Å—á–µ—Ç—ã –Ω–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ "Gold Analytics Pro" –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —Ü–µ–ª—è—Ö. –û–Ω–∏ –ù–ï —è–≤–ª—è—é—Ç—Å—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–º —Å–æ–≤–µ—Ç–æ–º, —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–µ–π –∫ –ø–æ–∫—É–ø–∫–µ/–ø—Ä–æ–¥–∞–∂–µ –∞–∫—Ç–∏–≤–æ–≤ –∏–ª–∏ —Ç–æ—Ä–≥–æ–≤—ã–º —Å–∏–≥–Ω–∞–ª–æ–º.</p>
            
            <p><strong>–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≥–∞—Ä–∞–Ω—Ç–∏–π:</strong><br>
            –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∞–±—Å–æ–ª—é—Ç–Ω—É—é —Ç–æ—á–Ω–æ—Å—Ç—å, –ø–æ–ª–Ω–æ—Ç—É –∏–ª–∏ –∞–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –æ–ø—Ü–∏–æ–Ω–∞–º –∏ —Ñ—å—é—á–µ—Ä—Å–∞–º –º–æ–∂–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –∏–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏, –∑–∞–≤–∏—Å—è—â–∏–µ –æ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–∞–Ω–Ω—ã—Ö.</p>
            
            <p><strong>–í—ã—Å–æ–∫–∏–π —Ä–∏—Å–∫:</strong><br>
            –¢–æ—Ä–≥–æ–≤–ª—è —Ñ—å—é—á–µ—Ä—Å–∞–º–∏ –∏ –æ–ø—Ü–∏–æ–Ω–∞–º–∏, –æ—Å–æ–±–µ–Ω–Ω–æ –≤–Ω—É—Ç—Ä–∏–¥–Ω–µ–≤–Ω—ã–º–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞–º–∏ (0DTE), —Å–æ–ø—Ä—è–∂–µ–Ω–∞ —Å —á—Ä–µ–∑–≤—ã—á–∞–π–Ω–æ –≤—ã—Å–æ–∫–∏–º —Ä–∏—Å–∫–æ–º –ø–æ–ª–Ω–æ–π –ø–æ—Ç–µ—Ä–∏ –∫–∞–ø–∏—Ç–∞–ª–∞. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ—Å–µ—Ç –ø–æ–ª–Ω—É—é –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–≤–æ–∏ —Ç–æ—Ä–≥–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è.</p>
            
            <p><strong>–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏:</strong><br>
            –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ª—é–±—ã–µ —Ñ–∏–Ω–∞–Ω—Å–æ–≤—ã–µ —É–±—ã—Ç–∫–∏, —É–ø—É—â–µ–Ω–Ω—É—é –≤—ã–≥–æ–¥—É –∏–ª–∏ –¥—Ä—É–≥–∏–µ –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏—è, –≤–æ–∑–Ω–∏–∫—à–∏–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</p>
            
            <p><strong>–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö:</strong><br>
            –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ø—É–±–ª–∏—á–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ —É–¥–æ–±—Å—Ç–≤–∞ –∞–Ω–∞–ª–∏–∑–∞. –î–∞–Ω–Ω—ã–µ –Ω–µ –ø—Ä–æ—Ö–æ–¥—è—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—É—é —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –±–∏—Ä–∂–∏.</p>
            
            <hr style="border-color: #444; margin: 20px 0;">
            
            <h2>üîí –ü–û–õ–ò–¢–ò–ö–ê –ö–û–ù–§–ò–î–ï–ù–¶–ò–ê–õ–¨–ù–û–°–¢–ò</h2>
            
            <p><strong>–°–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö:</strong><br>
            –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ "Gold Analytics Pro" –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π. –í—Å–µ —Ä–∞—Å—á–µ—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ.</p>
            
            <p><strong>Cookies:</strong><br>
            –°–∞–π—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ cookies –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞. –ú—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º —Ä–µ–∫–ª–∞–º–Ω—ã–µ –∏–ª–∏ –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–µ cookies —Ç—Ä–µ—Ç—å–∏—Ö —Å—Ç–æ—Ä–æ–Ω.</p>
            
            <p><strong>–í–Ω–µ—à–Ω–∏–µ —Å—Å—ã–ª–∫–∏:</strong><br>
            –°–∞–π—Ç –º–æ–∂–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Å—Å—ã–ª–∫–∏ –Ω–∞ –≤–Ω–µ—à–Ω–∏–µ —Ä–µ—Å—É—Ä—Å—ã. –ú—ã –Ω–µ –Ω–µ—Å–µ–º –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞ –ø–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏ —ç—Ç–∏—Ö —Å–∞–π—Ç–æ–≤.</p>
            
            <p><strong>–ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ–ª–∏—Ç–∏–∫–∏:</strong><br>
            –ú—ã –æ—Å—Ç–∞–≤–ª—è–µ–º –∑–∞ —Å–æ–±–æ–π –ø—Ä–∞–≤–æ –∏–∑–º–µ–Ω—è—Ç—å –¥–∞–Ω–Ω—É—é –ø–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏. –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –≤—Å–µ–≥–¥–∞ –¥–æ—Å—Ç—É–ø–Ω–∞ –Ω–∞ —Å–∞–π—Ç–µ.</p>
            
            <button class="close-disclaimer" onclick="closeDisclaimer()">–ü–æ–Ω—è—Ç–Ω–æ</button>
            <div style="clear:both;"></div>
        </div>
    </div>

    <section class="live-data">
        
        <div class="warning-block">
            <div class="warning-title">‚ö† –°–¢–ê–¢–£–° –î–ê–ù–ù–´–•</div>
            <p class="warning-text">
                –û–ø—Ü–∏–æ–Ω–Ω—ã–µ —É—Ä–æ–≤–Ω–∏ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π 5 –º–∏–Ω—É—Ç.<br>
                –¶–µ–Ω–∞ —Ñ—å—é—á–µ—Ä—Å–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π –¥–æ 5 —Å–µ–∫—É–Ω–¥.<br>
                –ò–Ω—Ç—Ä–∞–¥–µ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∫–∞–∂–¥—ã–µ 10 —Å–µ–∫—É–Ω–¥.
            </p>
        </div>

        <!-- üî• ALERTS -->
        <div id="alerts-container" class="alerts-container">
            <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è–µ—Ç—Å—è -->
        </div>
        
        <div class="data-container">
            <div class="data-card">
                <div class="small-text">–¶–µ–Ω–∞ (Live)</div>
                <div class="big-number" id="futures-price">...</div>
            </div>
            
            <div class="data-card" style="min-width: 180px;">
                <div class="pcr-grid">
                    <div class="pcr-item">
                        <div id="pcr-oi">...</div>
                        <div>PCR (OI)</div>
                    </div>
                    <div class="pcr-item">
                        <div id="pcr-vol">...</div>
                        <div>PCR (Vol)</div>
                    </div>
                </div>
            </div>
            
            <div class="data-card">
                <div class="small-text">–ë–∞–ª–∞–Ω—Å</div>
                <div class="big-number" id="balance-price">...</div>
            </div>
            <div class="data-card" style="min-width: 200px;">
                <div class="small-text" style="color: var(--accent-gold); font-weight: bold; line-height: 1.2;">
                    –ü–û–°–õ–ï–î–ù–ï–ï –û–ë–ù–û–í–õ–ï–ù–ò–ï<br>–î–ê–ù–ù–´–• –ü–û UTC
                </div>
                <div class="big-number" id="updated-time" style="font-size: 1.1em; margin-top: 5px;">--.--.---- --:--:--</div>
            </div>
        </div>

        <!-- üî• –ò–ù–¢–†–ê–î–ï–ô –ê–ù–ê–õ–ò–¢–ò–ö–ê -->
        <div id="analytics" class="analytics-grid">
            <!-- Max Pain -->
            <div class="analytics-card">
                <div class="analytics-title">üéØ Max Pain</div>
                <div class="analytics-value" id="max-pain-value">-</div>
                <div class="analytics-label">–¢–æ—á–∫–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –±–æ–ª–∏</div>
            </div>
            
            <!-- 1. Expected Move -->
            <div class="analytics-card">
                <div class="analytics-title">
                    üìè Expected Move (¬±1œÉ)
                    <span class="analytics-help">‚ùì
                        <span class="analytics-annotation">
                            <strong>–û–∂–∏–¥–∞–µ–º–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ:</strong> –î–∏–∞–ø–∞–∑–æ–Ω (68% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏), –≤ –∫–æ—Ç–æ—Ä–æ–º —Ü–µ–Ω–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –¥–æ —ç–∫—Å–ø–∏—Ä–∞—Ü–∏–∏. –†–∞—Å—Å—á–∏—Ç–∞–Ω–æ –Ω–∞ –æ—Å–Ω–æ–≤–µ IV.
                        </span>
                    </span>
                </div>
                <div class="analytics-value" id="exp-move-value" style="color: var(--accent-gold);">-</div>
                <div class="analytics-label" id="exp-move-range">–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∏–∞–ø–∞–∑–æ–Ω–∞...</div>
            </div>
            
            <!-- 2. Probabilities (ITM) -->
            <div class="analytics-card">
                <div class="analytics-title">
                    üéØ ITM Probability
                    <span class="analytics-help">‚ùì
                        <span class="analytics-annotation">
                            –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ —Ü–µ–Ω–∞ –æ–∫–∞–∂–µ—Ç—Å—è "–≤ –¥–µ–Ω—å–≥–∞—Ö" –∫ –º–æ–º–µ–Ω—Ç—É —ç–∫—Å–ø–∏—Ä–∞—Ü–∏–∏. –û—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ –î–µ–ª—å—Ç–µ ATM –æ–ø—Ü–∏–æ–Ω–æ–≤.
                        </span>
                    </span>
                </div>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                    <div style="text-align: center;">
                        <div style="color: var(--call-color); font-weight: bold; font-size: 1.2em;" id="prob-call">-</div>
                        <div style="font-size: 0.7em; color: #888;">CALL ITM</div>
                    </div>
                    <div style="text-align: center;">
                        <div style="color: var(--put-color); font-weight: bold; font-size: 1.2em;" id="prob-put">-</div>
                        <div style="font-size: 0.7em; color: #888;">PUT ITM</div>
                    </div>
                </div>
            </div>
            
            <!-- 3. Advanced Greeks (Charm/Color) -->
            <div class="analytics-card">
                <div class="analytics-title">
                    üåÄ Advanced Greeks
                    <span class="analytics-help">‚ùì
                        <span class="analytics-annotation">
                            <strong>Color:</strong> –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ì–∞–º–º—ã –≤–æ –≤—Ä–µ–º–µ–Ω–∏. <br><strong>Charm:</strong> –°–∫–æ—Ä–æ—Å—Ç—å —Ä–∞—Å–ø–∞–¥–∞ –î–µ–ª—å—Ç—ã. –í–∞–∂–Ω–æ –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–∞ –Ω–∞ –≤—ã—Ö–æ–¥–Ω—ã—Ö.
                        </span>
                    </span>
                </div>
                <div style="display: flex; flex-direction: column; gap: 5px; margin-top: 5px;">
                    <div class="level-item" style="border: none; background: rgba(255,255,255,0.05);">
                        <span style="font-size: 0.8em; color: #888;">Color (Œì Decay):</span>
                        <span id="metric-color" style="font-weight: bold;">-</span>
                    </div>
                    <div class="level-item" style="border: none; background: rgba(255,255,255,0.05);">
                        <span style="font-size: 0.8em; color: #888;">Charm (Œî Decay):</span>
                        <span id="metric-charm" style="font-weight: bold;">-</span>
                    </div>
                </div>
            </div>
            
            <!-- 4. Economic Calendar -->
            <div class="analytics-card">
                <div class="analytics-title">üìÖ Economic Calendar</div>
                <div id="calendar-list" style="margin-top: 10px; font-size: 0.85em;">
                    <div class="analytics-label">–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–±—ã—Ç–∏–π...</div>
                </div>
            </div>

            <!-- Zero Gamma -->
            <div class="analytics-card">
                <div class="analytics-title">‚ö° Zero Gamma Level</div>
                <div class="analytics-value" id="zero-gamma-value">-</div>
                <div class="analytics-label" id="zero-gamma-label">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>

            <!-- Vanna Exposure -->
            <div class="analytics-card">
                <div class="analytics-title">üåÄ Vanna Exposure</div>
                <div class="analytics-value" id="vanna-net">-</div>
                <div class="analytics-label" id="vanna-label">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
            </div>

            <!-- GEX Walls -->
            <div class="analytics-card">
                <div class="analytics-title">üß± GEX Walls (Res/Sup)</div>
                <div id="key-levels-display" style="margin-top: 10px;">
                    <div class="analytics-label">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                </div>
            </div>
        </div>

        <!-- üî• –ì–†–ê–§–ò–ö–ò -->
        <div id="charts" class="charts-container">
            <!-- 1. OI Distribution -->
            <div class="chart-box">
                <div class="chart-title">
                    üìä OI Distribution (Call vs Put)
                    <span class="chart-help">‚ùì
                        <span class="chart-annotation">
                            <strong>–ö–∞–∫ —á–∏—Ç–∞—Ç—å:</strong> –°–∏–Ω–∏–π (Calls) = –°–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ —Å–≤–µ—Ä—Ö—É. –û—Ä–∞–Ω–∂–µ–≤—ã–π (Puts) = –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Å–Ω–∏–∑—É. –ï—Å–ª–∏ —Å–∏–Ω–∏—Ö —Å—Ç–æ–ª–±—Ü–æ–≤ –º–Ω–æ–≥–æ ‚Äî —Ü–µ–Ω–µ —Ç—Ä—É–¥–Ω–æ —Ä–∞—Å—Ç–∏.
                        </span>
                    </span>
                </div>
                <div class="chart-wrapper">
                    <canvas id="oiChart"></canvas>
                </div>
            </div>

            <!-- 2. Volume Heatmap -->
            <div class="chart-box">
                <div class="chart-title">
                    üìà Volume Heatmap
                    <span class="chart-help">‚ùì
                        <span class="chart-annotation">
                            <strong>–ö–∞–∫ —á–∏—Ç–∞—Ç—å:</strong> –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç ¬´–∂–∏–≤—ã–µ¬ª –¥–µ–Ω—å–≥–∏ –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å. –í—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º –Ω–∞ –ó–µ–ª–µ–Ω—ã—Ö (Calls) –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ —É—Ä–æ–≤–Ω–∏ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è –∞–∫—Ç–∏–≤–Ω–æ –∑–∞—â–∏—â–∞—é—Ç. –í—ã—Å–æ–∫–∏–π –æ–±—ä–µ–º –Ω–∞ –ö—Ä–∞—Å–Ω—ã—Ö (Puts) ‚Äî —É—Ä–æ–≤–Ω–∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ –≤—ã–∫—É–ø–∞—é—Ç.
                        </span>
                    </span>
                </div>
                <div class="chart-wrapper">
                    <canvas id="volumeChart"></canvas>
                </div>
            </div>

            <!-- 3. Gamma Exposure -->
            <div class="chart-box">
                <div class="chart-title">
                    ‚ö° Gamma Exposure (GEX)
                    <span class="chart-help">‚ùì
                        <span class="chart-annotation">
                            <strong>–ö–∞–∫ —á–∏—Ç–∞—Ç—å:</strong> –ü–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω–∞—è Gamma (–ö–æ–ª–ª—ã) = —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ —Ä–æ—Å—Ç—É, MM –ø—Ä–æ–¥–∞—é—Ç –ø—Ä–∏ —Ä–æ—Å—Ç–µ —Ü–µ–Ω—ã, –∑–∞–º–µ–¥–ª—è—è –µ—ë. –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è Gamma (–ü—É—Ç—ã) = –ø–æ–¥–¥–µ—Ä–∂–∫–∞, MM –ø–æ–∫—É–ø–∞—é—Ç –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏, —É–¥–µ—Ä–∂–∏–≤–∞—è —Ü–µ–Ω—É.
                        </span>
                    </span>
                </div>
                <div class="chart-wrapper">
                    <canvas id="gammaChart"></canvas>
                </div>
            </div>

            <!-- 4. Max Pain Analysis -->
            <div class="chart-box">
                <div class="chart-title">
                    üéØ Max Pain Curve
                    <span class="chart-help">‚ùì
                        <span class="chart-annotation">
                            <strong>–ö–∞–∫ —á–∏—Ç–∞—Ç—å:</strong> –ú–∏–Ω–∏–º—É–º –Ω–∞ –≥—Ä–∞—Ñ–∏–∫–µ = Max Pain (—Ç–æ—á–∫–∞, –≥–¥–µ –æ–ø—Ü–∏–æ–Ω—ã —Ç–µ—Ä—è—é—Ç –º–∞–∫—Å–∏–º—É–º —Å—Ç–æ–∏–º–æ—Å—Ç–∏). –¶–µ–Ω–∞ —Å—Ç—Ä–µ–º–∏—Ç—Å—è –∫ —ç—Ç–æ–π —Ç–æ—á–∫–µ –∫ —ç–∫—Å–ø–∏—Ä–∞—Ü–∏–∏. –ß–µ–º –¥–∞–ª—å—à–µ –æ—Ç Max Pain, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ "–ø—Ä–∏—Ç—è–∂–µ–Ω–∏–µ".
                        </span>
                    </span>
                </div>
                <div class="chart-wrapper">
                    <canvas id="maxPainChart"></canvas>
                </div>
            </div>

            <!-- 5. IV Smile -->
            <div class="chart-box">
                <div class="chart-title">
                    üåà IV Smile
                    <span class="chart-help">‚ùì
                        <span class="chart-annotation">
                            <strong>–ö–∞–∫ —á–∏—Ç–∞—Ç—å:</strong> "–£–ª—ã–±–∫–∞" = —Ä—ã–Ω–æ–∫ –∂–¥–µ—Ç —Å–∏–ª—å–Ω–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ. –ï—Å–ª–∏ Put IV > Call IV (–ø–µ—Ä–µ–∫–æ—Å –≤–ø—Ä–∞–≤–æ) = —Å—Ç—Ä–∞—Ö –ø–∞–¥–µ–Ω–∏—è. –ü–ª–æ—Å–∫–∞—è –ª–∏–Ω–∏—è = —Å–ø–æ–∫–æ–π–Ω—ã–π —Ä—ã–Ω–æ–∫.
                        </span>
                    </span>
                </div>
                <div class="chart-wrapper">
                    <canvas id="ivChart"></canvas>
                </div>
            </div>

            <!-- 6. Delta Profile -->
            <div class="chart-box">
                <div class="chart-title">
                    ‚öñÔ∏è Delta Profile
                    <span class="chart-help">‚ùì
                        <span class="chart-annotation">
                            <strong>–ö–∞–∫ —á–∏—Ç–∞—Ç—å:</strong> Delta –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ—Å—Ç—å –ø–æ–∑–∏—Ü–∏–π. –ï—Å–ª–∏ Call Delta > Put Delta = –±—ã—á–∏–π –Ω–∞—Å—Ç—Ä–æ–π. –ë–æ–ª—å—à–∏–µ —Å—Ç–æ–ª–±—Ü—ã = –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã—Ö —Å—Ç–∞–≤–æ–∫ –Ω–∞ —É—Ä–æ–≤–Ω–µ.
                        </span>
                    </span>
                </div>
                <div class="chart-wrapper">
                    <canvas id="deltaChart"></canvas>
                </div>
            </div>

            <!-- 7. GEX Profile -->
            <div class="chart-box">
                <div class="chart-title">
                    üî• GEX Profile
                    <span class="chart-help">‚ùì
                        <span class="chart-annotation">
                            <strong>–ö–∞–∫ —á–∏—Ç–∞—Ç—å:</strong> –ó–µ–ª–µ–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã (Calls) = –∑–æ–Ω—ã —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏—è. –ö—Ä–∞—Å–Ω—ã–µ —Å—Ç–æ–ª–±—Ü—ã (Puts) = –∑–æ–Ω—ã –ø–æ–¥–¥–µ—Ä–∂–∫–∏. –ß–µ–º –≤—ã—à–µ —Å—Ç–æ–ª–±—Ü—ã, —Ç–µ–º —Å–∏–ª—å–Ω–µ–µ —É—Ä–æ–≤–µ–Ω—å.
                        </span>
                    </span>
                </div>
                <div class="chart-wrapper">
                    <canvas id="gexChart"></canvas>
                </div>
            </div>

            <!-- 8. Theta Decay -->
            <div class="chart-box">
                <div class="chart-title">
                    ‚è±Ô∏è Theta Decay
                    <span class="chart-help">‚ùì
                        <span class="chart-annotation">
                            <strong>–ö–∞–∫ —á–∏—Ç–∞—Ç—å:</strong> Theta = –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞—Å–ø–∞–¥ –æ–ø—Ü–∏–æ–Ω–æ–≤. –ß–µ–º –Ω–∏–∂–µ –ª–∏–Ω–∏—è, —Ç–µ–º –±—ã—Å—Ç—Ä–µ–µ –æ–ø—Ü–∏–æ–Ω—ã —Ç–µ—Ä—è—é—Ç —Å—Ç–æ–∏–º–æ—Å—Ç—å. –í—ã—Å–æ–∫–∞—è Theta –Ω–∞ ATM = –ø—Ä–æ–¥–∞–≤—Ü—ã –æ–ø—Ü–∏–æ–Ω–æ–≤ –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –º–∞–∫—Å–∏–º—É–º.
                        </span>
                    </span>
                </div>
                <div class="chart-wrapper">
                    <canvas id="thetaChart"></canvas>
                </div>
            </div>
        </div>

        <!-- üî• –ì–†–ï–ö–ò (–ù–û–í–´–ô –†–ê–ó–î–ï–õ) -->
        <div id="greeks" style="max-width: 1200px; margin: 0 auto 30px auto;">
            <h2 style="text-align: center; color: var(--accent-gold); margin-bottom: 20px;">üéì Greeks Analytics</h2>
            
            <div class="analytics-grid">
                <div class="analytics-card">
    <div class="analytics-title">‚öñÔ∏è Delta Skew</div>
    <div class="analytics-value" id="delta-skew-value">-</div>
    <div class="analytics-label">Call Delta - Put Delta</div>
</div>
                <!-- 1. Total Call Delta -->
                <div class="analytics-card">
                    <div class="analytics-title">
                        Œî Total Call Delta
                        <span class="analytics-help">‚ùì
                            <span class="analytics-annotation">
                                Delta –ö–æ–ª–ª–æ–≤ ‚Äî —ç—Ç–æ —Å–æ–≤–æ–∫—É–ø–Ω–æ–µ —Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ. –ß–µ–º –≤—ã—à–µ —ç—Ç–æ –∑–Ω–∞—á–µ–Ω–∏–µ, —Ç–µ–º –±–æ–ª—å—à–µ ¬´—Å—Ç–µ–Ω¬ª –∏–∑ –ª–∏–º–∏—Ç–Ω—ã—Ö –∑–∞—è–≤–æ–∫ —Å—Ç–æ–∏—Ç –≤—ã—à–µ —Ç–µ–∫—É—â–µ–π —Ü–µ–Ω—ã.
                            </span>
                        </span>
                    </div>
                    <div class="analytics-value" id="total-call-delta">-</div>
                </div>

                <!-- 2. Total Put Delta -->
                <div class="analytics-card">
                    <div class="analytics-title">
                        Œî Total Put Delta
                        <span class="analytics-help">‚ùì
                            <span class="analytics-annotation">
                                Delta –ü—É—Ç–æ–≤ ‚Äî —ç—Ç–æ —Å–æ–≤–æ–∫—É–ø–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞. –í—ã—Å–æ–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Å–∏–ª—å–Ω–æ–µ –∂–µ–ª–∞–Ω–∏–µ —Ä—ã–Ω–∫–∞ —É–¥–µ—Ä–∂–∏–≤–∞—Ç—å —Ç–µ–∫—É—â–∏–µ —É—Ä–æ–≤–Ω–∏ —Å–Ω–∏–∑—É.
                            </span>
                        </span>
                    </div>
                    <div class="analytics-value" id="total-put-delta">-</div>
                </div>

                <!-- 3. Total Gamma -->
                <div class="analytics-card">
                    <div class="analytics-title">
                        Œì Total Gamma
                        <span class="analytics-help">‚ùì
                            <span class="analytics-annotation">
                                Gamma = —É—Å–∫–æ—Ä–µ–Ω–∏–µ Delta. –í—ã—Å–æ–∫–∞—è Gamma = —Ä–µ–∑–∫–∏–µ –¥–≤–∏–∂–µ–Ω–∏—è —Ü–µ–Ω—ã –ø—Ä–∏ –ø—Ä–æ–±–æ–µ —É—Ä–æ–≤–Ω–µ–π. –†–∏—Å–∫ Gamma Squeeze.
                            </span>
                        </span>
                    </div>
                    <div class="analytics-value" id="total-gamma">-</div>
                </div>

                <!-- 4. Total Vega -->
                <div class="analytics-card">
                    <div class="analytics-title">
                        ŒΩ Total Vega
                        <span class="analytics-help">‚ùì
                            <span class="analytics-annotation">
                                Vega = —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫ –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç–∏. –í—ã—Å–æ–∫–∞—è Vega = –æ–ø—Ü–∏–æ–Ω—ã —Å–∏–ª—å–Ω–æ —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–µ IV.
                            </span>
                        </span>
                    </div>
                    <div class="analytics-value" id="total-vega">-</div>
                </div>

                <!-- 5. Total Theta -->
                <div class="analytics-card">
                    <div class="analytics-title">
                        Œò Total Theta
                        <span class="analytics-help">‚ùì
                            <span class="analytics-annotation">
                                Theta = –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ä–∞—Å–ø–∞–¥. –û—Ç—Ä–∏—Ü–∞—Ç–µ–ª—å–Ω–∞—è = –ø–æ–∫—É–ø–∞—Ç–µ–ª–∏ –æ–ø—Ü–∏–æ–Ω–æ–≤ —Ç–µ—Ä—è—é—Ç –¥–µ–Ω—å–≥–∏ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å. –ü—Ä–æ–¥–∞–≤—Ü—ã –∑–∞—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç.
                            </span>
                        </span>
                    </div>
                    <div class="analytics-value" id="total-theta">-</div>
                </div>

                <!-- 6. Avg IV -->
                <div class="analytics-card">
                    <div class="analytics-title">
                        üìä Avg IV
                        <span class="analytics-help">‚ùì
                            <span class="analytics-annotation">
                                IV = –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞–µ–º–∞—è –≤–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å. –í—ã—Å–æ–∫–∞—è IV (>30%) = –¥–æ—Ä–æ–≥–∏–µ –æ–ø—Ü–∏–æ–Ω—ã, —Ä—ã–Ω–æ–∫ –∂–¥–µ—Ç —Å–∏–ª—å–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏–π.
                            </span>
                        </span>
                    </div>
                    <div class="analytics-value" id="avg-iv">-</div>
                </div>
            </div>
        </div>

        <div class="control-panel">
            <!-- –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ –≠–ö–°–ü–ò–†–ê–¶–ò–ô -->
            <div class="expiry-toggle">
                <span class="filter-label">–≠–∫—Å–ø–∏—Ä–∞—Ü–∏—è:</span>
                <button class="expiry-btn active" data-expiry="0dte">INTRADAY</button>
                <button class="expiry-btn" data-expiry="friday">FRIDAY</button>
            </div>

            <div class="calculator-panel">
                <label style="color:#fff; font-weight:bold;">Forward (–§–æ—Ä–≤–∞—Ä–¥):</label>
                <input type="number" id="forward-input" class="calc-input" placeholder="0" step="0.5" value="0">
                
                <label style="color:#fff; font-weight:bold;">–†–∞—Å—á–µ—Ç –ø—Ä–µ–º–∏–π:</label>
                <button class="premium-btn" id="premium-toggle">–í–∫–ª. –ø—Ä–µ–º–∏–∏</button>
                <span style="color: #888; font-size: 0.85em;">(Call+Prem, Put-Prem)</span>
            </div>

            <div class="strike-filter">
                <span class="filter-label">–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç—Ä–∞–π–∫–æ–≤:</span>
                <button class="filter-btn" data-count="50">50</button>
                <button class="filter-btn active" data-count="75">75</button>
                <button class="filter-btn" data-count="100">100</button>
                <button class="filter-btn" data-count="125">125</button>
                <button class="filter-btn" data-count="150">150</button>
            </div>
        </div>

        <div id="top5" class="top5-container">
            <div class="top5-box">
                <div class="top5-title">üü¢ CALLS - –¢–û–ü-5</div>
                <div class="top5-grid">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <div style="color: #888; font-size: 0.85em; margin-bottom: 8px; text-align: center;">–ü–æ Volume</div>
                            <div id="top5-call-vol"></div>
                        </div>
                        <div>
                            <div style="color: #888; font-size: 0.85em; margin-bottom: 8px; text-align: center;">–ü–æ OI</div>
                            <div id="top5-call-oi"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="top5-box">
                <div class="top5-title">üî¥ PUTS - –¢–û–ü-5</div>
                <div class="top5-grid">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <div>
                            <div style="color: #888; font-size: 0.85em; margin-bottom: 8px; text-align: center;">–ü–æ Volume</div>
                            <div id="top5-put-vol"></div>
                        </div>
                        <div>
                            <div style="color: #888; font-size: 0.85em; margin-bottom: 8px; text-align: center;">–ü–æ OI</div>
                            <div id="top5-put-oi"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="levels-container">
            <div class="table-header-info">
                <span id="table-expiry-label">INTRADAY</span>
                <span style="color:#888;">Full Analytics Active</span>
            </div>
            
            <div class="table-wrapper">
                <table>
                    <thead>
                        <tr>
                            <th colspan="5" style="border-bottom: 2px solid var(--call-color);">CALLS</th>
                            <th style="background:#222;"></th>
                            <th colspan="5" style="border-bottom: 2px solid var(--put-color);">PUTS</th>
                        </tr>
                        <tr>
                            <th>OI</th><th>Vol</th><th>Prem</th><th>Œî</th><th>Œì</th>
                            <th style="background:#333; color:#fff;">STRIKE</th>
                            <th>Œì</th><th>Œî</th><th>Prem</th><th>Vol</th><th>OI</th>
                        </tr>
                    </thead>
                    <tbody id="option-body">
                        <tr><td colspan="11" style="padding: 20px;">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</td></tr>
                    </tbody>
                </table>
            </div>
        </div>
    </section>

    <section id="download" class="download">
        <h2>–°–∫–∞—á–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</h2>
        
        <!-- üî• –ù–û–í–´–ô –ë–õ–û–ö –° –ü–†–ï–î–£–ü–†–ï–ñ–î–ï–ù–ò–ï–ú -->
        <div class="security-info">
            <div class="security-card">
                <div class="security-icon">üîí</div>
                <h3>–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫–∏</h3>
                <p>
                    –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ APK-—Ñ–∞–π–ª–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ <strong>—Ä–∞–∑—Ä–µ—à–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É –∏–∑ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤</strong> 
                    –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Android (–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å ‚Üí –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏).
                </p>
                <p>
                    –ù–∞—à APK-—Ñ–∞–π–ª <strong>–Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤–∏—Ä—É—Å–æ–≤</strong> –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑–æ–ø–∞—Å–µ–Ω. 
                    –ú—ã –Ω–µ —Å–æ–±–∏—Ä–∞–µ–º –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –Ω–µ —Ç—Ä–µ–±—É–µ–º –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π.
                </p>
                <details class="install-guide">
                    <summary>üìñ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —É—Å—Ç–∞–Ω–æ–≤–∫–µ</summary>
                    <ol>
                        <li>–°–∫–∞—á–∞–π—Ç–µ APK-—Ñ–∞–π–ª –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ</li>
                        <li>–û—Ç–∫—Ä–æ–π—Ç–µ <strong>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ ‚Üí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å</strong></li>
                        <li>–í–∫–ª—é—á–∏—Ç–µ <strong>"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏"</strong> –∏–ª–∏ <strong>"–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏–∑ –¥—Ä—É–≥–∏—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤"</strong></li>
                        <li>–û—Ç–∫—Ä–æ–π—Ç–µ —Å–∫–∞—á–∞–Ω–Ω—ã–π —Ñ–∞–π–ª –∏ –Ω–∞–∂–º–∏—Ç–µ <strong>"–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å"</strong></li>
                        <li>–ü–æ—Å–ª–µ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –æ–±—Ä–∞—Ç–Ω–æ</li>
                    </ol>
                </details>
            </div>
        </div>
        
        <div class="download-card">
            <h3>Android APK</h3>
            <p style="color:#888;">–í–µ—Ä—Å–∏—è 3.0</p>
            <a href="downloads/gold-options3.apk" download class="btn-download">üì• –°–∫–∞—á–∞—Ç—å APK</a>
            <p class="apk-size">–†–∞–∑–º–µ—Ä: ~9.4 –ú–ë</p>
        </div>
        
        <div style="margin-top: 30px;">
            <span class="disclaimer-link" onclick="openDisclaimer()">üìÑ Disclaimer & Privacy Policy</span>
        </div>
    </section>

    <footer>
        <p>&copy; 2025 Gold Options Pro Analytics. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å" –±–µ–∑ –≥–∞—Ä–∞–Ω—Ç–∏–π.</p>
        <p style="margin-top: 10px;">
            <a href="#" onclick="openDisclaimer(); return false;" style="color: var(--accent-gold);">–û—Ç–∫–∞–∑ –æ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏</a> | 
            <a href="#" onclick="openDisclaimer(); return false;" style="color: var(--accent-gold);">–ü–æ–ª–∏—Ç–∏–∫–∞ –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏</a>
        </p>
    </footer>

    <script>
        const DB_ROOT = "https://cmeparser-default-rtdb.europe-west1.firebasedatabase.app";
        
        let currentFuturesPrice = 0;
        let cachedTableData = []; 
        let forwardCorrection = 0;
        let displayStrikeCount = 75;
        let currentExpiry = '0dte';
        let premiumEnabled = false;

        // üî• –ì–†–ê–§–ò–ö–ò
        let oiChart, volumeChart, gammaChart, maxPainChart;
        let ivChart, deltaChart, gexChart, thetaChart;
        
        // ==========================================================================
        // üî• WEBSOCKET –ü–û–î–ö–õ–Æ–ß–ï–ù–ò–ï
        // ==========================================================================
        let ws;
        let reconnectInterval = 3000;
        
        function connectWebSocket() {
            const wsUrl = "wss://askhat777-gold-relay.hf.space/ws";
            console.log(`üîå –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫: ${wsUrl}`);
            
            ws = new WebSocket(wsUrl);
            
            ws.onopen = () => {
                console.log('‚úÖ WebSocket —É—Å–ø–µ—à–Ω–æ –ø–æ–¥–∫–ª—é—á–µ–Ω!');
                // üî• –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û: –û—Ç–ø—Ä–∞–≤–ª—è–µ–º —Ç–æ–∫–µ–Ω –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                ws.send(JSON.stringify({"auth": "askhat_secret_2025"})); 

                const updateEl = document.getElementById('updated-time');
                if(updateEl) {
                    updateEl.innerHTML = '<span style="color:#4caf50">‚óè ONLINE (Auth OK)</span>';
                }
            };
            
            ws.onmessage = (event) => {
                try {
                    const msg = JSON.parse(event.data);
                    
                    if (msg.type === 'status') {
                        const statusEl = document.querySelector('.warning-block .warning-text');
                        if (msg.data && msg.data.publisher_online) {
                            statusEl.innerHTML = `
                                <span style="color:#4caf50; font-weight:bold;">üü¢ –ü–ê–†–°–ï–† –û–ù–õ–ê–ô–ù</span><br>
                                –î–∞–Ω–Ω—ã–µ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.
                            `;
                        }
                    }
                    
                    if (msg.type === 'price') {
                        currentFuturesPrice = msg.data.price;
                        
                        const warnEl = document.querySelector('.warning-block .warning-text');
                        warnEl.innerHTML = `
                            <span style="color:#4caf50; font-weight:bold;">üü¢ LIVE</span> | 
                            –ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: ${msg.data.updated_at}
                        `;
                        
                        const priceEl = document.getElementById('futures-price');
                        if (priceEl) {
                            priceEl.innerText = '$' + msg.data.price.toFixed(1);
                            priceEl.style.color = '#fff';
                            setTimeout(() => priceEl.style.color = 'var(--accent-gold)', 200);
                        }

                        if (cachedTableData && cachedTableData.length > 0) {
                            renderTable(cachedTableData);
                        }
                    }
                    
                    if (msg.type === 'analytics') {
                        console.log('üìä Analytics received:', msg.data);
                        updateAnalytics(msg.data);
                    }

                } catch (e) {
                    console.error("–û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ WS —Å–æ–æ–±—â–µ–Ω–∏—è:", e);
                }
            };
            
            ws.onerror = (error) => {
                console.error('‚ùå WebSocket –æ—à–∏–±–∫–∞:', error);
                const updateEl = document.getElementById('updated-time');
                if(updateEl) updateEl.innerHTML = '<span style="color:#f44336">‚óè CONNECTION ERROR</span>';
            };
            
            ws.onclose = () => {
                console.warn('üîå WebSocket –∑–∞–∫—Ä—ã—Ç. –†–µ–∫–æ–Ω–Ω–µ–∫—Ç —á–µ—Ä–µ–∑ 3 —Å–µ–∫...');
                const updateEl = document.getElementById('updated-time');
                if(updateEl) updateEl.innerHTML = '<span style="color:#ff9800">‚óè RECONNECTING...</span>';
                setTimeout(connectWebSocket, reconnectInterval);
            };
        }

        // ==========================================================================
        // HELPER FUNCTIONS
        // ==========================================================================
        function openDisclaimer() {
            document.getElementById('disclaimerModal').style.display = 'block';
        }

        function closeDisclaimer() {
            document.getElementById('disclaimerModal').style.display = 'none';
        }

        window.onclick = function(event) {
            const modal = document.getElementById('disclaimerModal');
            if (event.target == modal) {
                modal.style.display = 'none';
            }
        }

        function getValueClass(value) {
            if (value === 0) return 'val-0';
            if (value < 50) return 'val-1';
            if (value < 100) return 'val-2';
            if (value < 500) return 'val-3';
            if (value < 1000) return 'val-4';
            if (value < 2000) return 'val-5';
            if (value < 5000) return 'val-6';
            return 'val-7';
        }

        // ==========================================================================
        // üî• –ù–û–†–ú–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–• –î–õ–Ø –ì–†–ê–§–ò–ö–û–í
        // ==========================================================================
        function normalizeChartData(data, minPercentile = 5, maxPercentile = 95) {
            if (!data || data.length === 0) return data;
            
            // –£–±–∏—Ä–∞–µ–º –Ω—É–ª–µ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏
            const filtered = data.filter(val => val !== 0);
            if (filtered.length === 0) return data;
            
            const sorted = [...filtered].sort((a, b) => a - b);
            const minIndex = Math.floor((minPercentile / 100) * (sorted.length - 1));
            const maxIndex = Math.floor((maxPercentile / 100) * (sorted.length - 1));
            
            const minVal = sorted[minIndex];
            const maxVal = sorted[maxIndex];
            const range = maxVal - minVal;
            
            if (range === 0) return data;
            
            return data.map(val => {
                if (val === 0) return 0;
                const normalized = ((val - minVal) / range) * 100;
                return Math.max(0, Math.min(100, normalized));
            });
        }

        // ==========================================================================
        // üî• –°–û–ó–î–ê–ù–ò–ï –ì–†–ê–§–ò–ö–û–í (–ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –ö–û–î)
        // ==========================================================================
        function createCharts(data) {
            const strikes = data.map(r => r.strike);
            const callOI = data.map(r => r.call?.oi || 0);
            const putOI = data.map(r => r.put?.oi || 0);
            const callVol = data.map(r => r.call?.vol || 0);
            const putVol = data.map(r => r.put?.vol || 0);

            // üî• –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ª—É—á—à–µ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è
            const normalizedCallOI = normalizeChartData(callOI);
            const normalizedPutOI = normalizeChartData(putOI);
            const normalizedCallVol = normalizeChartData(callVol);
            const normalizedPutVol = normalizeChartData(putVol);

            // 1. OI Distribution - —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –Ω—É–ª–µ–≤–æ–π –ª–∏–Ω–∏–µ–π
            if (oiChart) oiChart.destroy();
            const ctxOI = document.getElementById('oiChart').getContext('2d');
            oiChart = new Chart(ctxOI, {
                type: 'bar',
                data: {
                    labels: strikes,
                    datasets: [{
                        label: 'Call OI',
                        data: normalizedCallOI,
                        backgroundColor: 'rgba(33, 150, 243, 0.8)',
                        borderColor: 'rgba(33, 150, 243, 1)',
                        borderWidth: 1,
                        barPercentage: 0.8,
                        categoryPercentage: 0.9
                    }, {
                        label: 'Put OI',
                        data: normalizedPutOI.map(v => -v),
                        backgroundColor: 'rgba(255, 152, 0, 0.8)',
                        borderColor: 'rgba(255, 152, 0, 1)',
                        borderWidth: 1,
                        barPercentage: 0.8,
                        categoryPercentage: 0.9
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { 
                        legend: { 
                            labels: { 
                                color: '#fff',
                                usePointStyle: true,
                                pointStyle: 'rect'
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    const rawIndex = context.dataIndex;
                                    const rawValue = context.datasetIndex === 0 ? callOI[rawIndex] : putOI[rawIndex];
                                    label += Math.round(rawValue);
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                color: '#888', 
                                maxRotation: 45,
                                autoSkip: true,
                                maxTicksLimit: 15
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            offset: false
                        },
                        y: { 
                            ticks: { 
                                color: '#888',
                                callback: function(value) {
                                    return Math.abs(value);
                                }
                            }, 
                            grid: { 
                                color: function(context) {
                                    if (context.tick.value === 0) {
                                        return '#666';
                                    }
                                    return '#333';
                                },
                                drawBorder: false
                            },
                            beginAtZero: false,
                            min: -100,
                            max: 100
                        }
                    }
                }
            });

            // 2. Volume Heatmap - —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –Ω—É–ª–µ–≤–æ–π –ª–∏–Ω–∏–µ–π –∏ –ø—É—Ç–∞–º–∏ –≤–Ω–∏–∑
            if (volumeChart) volumeChart.destroy();
            const ctxVol = document.getElementById('volumeChart').getContext('2d');
            volumeChart = new Chart(ctxVol, {
                type: 'bar',
                data: {
                    labels: strikes,
                    datasets: [{
                        label: 'Call Vol',
                        data: normalizedCallVol,
                        backgroundColor: 'rgba(76, 175, 80, 0.7)',
                        borderColor: 'rgba(76, 175, 80, 1)',
                        borderWidth: 1,
                        barPercentage: 0.8,
                        categoryPercentage: 0.9
                    }, {
                        label: 'Put Vol',
                        data: normalizedPutVol.map(v => -v),
                        backgroundColor: 'rgba(244, 67, 54, 0.7)',
                        borderColor: 'rgba(244, 67, 54, 1)',
                        borderWidth: 1,
                        barPercentage: 0.8,
                        categoryPercentage: 0.9
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { 
                        legend: { 
                            labels: { 
                                color: '#fff',
                                usePointStyle: true,
                                pointStyle: 'rect'
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    const rawIndex = context.dataIndex;
                                    const rawValue = context.datasetIndex === 0 ? callVol[rawIndex] : putVol[rawIndex];
                                    label += Math.round(rawValue);
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                color: '#888', 
                                maxRotation: 45,
                                autoSkip: true,
                                maxTicksLimit: 15
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            offset: false
                        },
                        y: { 
                            ticks: { 
                                color: '#888',
                                callback: function(value) {
                                    return Math.abs(value);
                                }
                            }, 
                            grid: { 
                                color: function(context) {
                                    if (context.tick.value === 0) {
                                        return '#666';
                                    }
                                    return '#333';
                                },
                                drawBorder: false
                            },
                            beginAtZero: false,
                            min: -100,
                            max: 100
                        }
                    }
                }
            });

            // 3. Gamma Exposure
            const gammaData = data.map(r => {
                const strike = parseFloat(r.strike);
                const callGamma = r.call?.gamma || 0;
                const putGamma = r.put?.gamma || 0;
                const callOI = r.call?.oi || 0;
                const putOI = r.put?.oi || 0;
                return ((callOI * callGamma) - (putOI * putGamma)) * strike * 100 / 1000000;
            });

            if (gammaChart) gammaChart.destroy();
            const ctxGamma = document.getElementById('gammaChart').getContext('2d');
            gammaChart = new Chart(ctxGamma, {
                type: 'line',
                data: {
                    labels: strikes,
                    datasets: [{
                        label: 'Gamma Exposure (M)',
                        data: gammaData,
                        backgroundColor: 'rgba(255, 215, 0, 0.2)',
                        borderColor: 'rgba(255, 215, 0, 1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            labels: { 
                                color: '#fff'
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `GEX: ${context.parsed.y.toFixed(2)}M`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                color: '#888', 
                                maxRotation: 45,
                                autoSkip: true,
                                maxTicksLimit: 15
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            offset: false
                        },
                        y: { 
                            ticks: { 
                                color: '#888',
                                callback: function(value) {
                                    return value + 'M';
                                }
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            beginAtZero: false
                        }
                    }
                }
            });

            // 4. Max Pain
            const maxPainData = strikes.map(testStrike => {
                let totalLoss = 0;
                data.forEach(s => {
                    const strike = parseFloat(s.strike);
                    const callOI = s.call?.oi || 0;
                    const putOI = s.put?.oi || 0;
                    if (testStrike > strike) {
                        totalLoss += (testStrike - strike) * callOI * 100;
                    }
                    if (testStrike < strike) {
                        totalLoss += (strike - testStrike) * putOI * 100;
                    }
                });
                return totalLoss / 1000000;
            });

            if (maxPainChart) maxPainChart.destroy();
            const ctxMaxPain = document.getElementById('maxPainChart').getContext('2d');
            maxPainChart = new Chart(ctxMaxPain, {
                type: 'line',
                data: {
                    labels: strikes,
                    datasets: [{
                        label: 'Total Loss (M)',
                        data: maxPainData,
                        backgroundColor: 'rgba(183, 28, 28, 0.2)',
                        borderColor: 'rgba(183, 28, 28, 1)',
                        borderWidth: 2,
                        fill: true,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            labels: { 
                                color: '#fff'
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Loss: ${context.parsed.y.toFixed(2)}M`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                color: '#888', 
                                maxRotation: 45,
                                autoSkip: true,
                                maxTicksLimit: 15
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            offset: false
                        },
                        y: { 
                            ticks: { 
                                color: '#888',
                                callback: function(value) {
                                    return value + 'M';
                                }
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            beginAtZero: false
                        }
                    }
                }
            });

            // 5. IV Smile
            const callIV = data.map(r => r.call?.iv || 0);
            const putIV = data.map(r => r.put?.iv || 0);

            if (ivChart) ivChart.destroy();
            const ctxIV = document.getElementById('ivChart').getContext('2d');
            ivChart = new Chart(ctxIV, {
                type: 'line',
                data: {
                    labels: strikes,
                    datasets: [{
                        label: 'Call IV',
                        data: callIV,
                        borderColor: '#2196F3',
                        backgroundColor: 'rgba(33, 150, 243, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 3
                    }, {
                        label: 'Put IV',
                        data: putIV,
                        borderColor: '#f44336',
                        backgroundColor: 'rgba(244, 67, 54, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            labels: { 
                                color: '#fff'
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${context.parsed.y.toFixed(2)}%`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                color: '#888', 
                                maxRotation: 45,
                                autoSkip: true,
                                maxTicksLimit: 15
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            offset: false
                        },
                        y: { 
                            ticks: { 
                                color: '#888',
                                callback: function(value) {
                                    return value + '%';
                                }
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Implied Volatility %',
                                color: '#888'
                            }
                        }
                    }
                }
            });

            // 6. Delta Profile - —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –Ω—É–ª–µ–≤–æ–π –ª–∏–Ω–∏–µ–π
            const callDelta = data.map(r => (r.call?.delta || 0) * (r.call?.oi || 0) / 1000);
            const putDelta = data.map(r => Math.abs(r.put?.delta || 0) * (r.put?.oi || 0) / 1000);

            if (deltaChart) deltaChart.destroy();
            const ctxDelta = document.getElementById('deltaChart').getContext('2d');
            deltaChart = new Chart(ctxDelta, {
                type: 'bar',
                data: {
                    labels: strikes,
                    datasets: [{
                        label: 'Call Delta Exposure',
                        data: callDelta,
                        backgroundColor: 'rgba(76, 175, 80, 0.7)',
                        borderColor: 'rgba(76, 175, 80, 1)',
                        borderWidth: 1,
                        barPercentage: 0.8,
                        categoryPercentage: 0.9
                    }, {
                        label: 'Put Delta Exposure',
                        data: putDelta.map(v => -v),
                        backgroundColor: 'rgba(244, 67, 54, 0.7)',
                        borderColor: 'rgba(244, 67, 54, 1)',
                        borderWidth: 1,
                        barPercentage: 0.8,
                        categoryPercentage: 0.9
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { 
                        legend: { 
                            labels: { 
                                color: '#fff',
                                usePointStyle: true,
                                pointStyle: 'rect'
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    let label = context.dataset.label || '';
                                    if (label) {
                                        label += ': ';
                                    }
                                    label += Math.abs(context.parsed.y).toFixed(1) + 'K';
                                    return label;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                color: '#888', 
                                maxRotation: 45,
                                autoSkip: true,
                                maxTicksLimit: 15
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            offset: false
                        },
                        y: { 
                            ticks: { 
                                color: '#888',
                                callback: function(value) {
                                    return Math.abs(value) + 'K';
                                }
                            }, 
                            grid: { 
                                color: function(context) {
                                    if (context.tick.value === 0) {
                                        return '#666';
                                    }
                                    return '#333';
                                },
                                drawBorder: false
                            },
                            beginAtZero: false
                        }
                    }
                }
            });

            // 7. GEX Profile - —Å —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –Ω—É–ª–µ–≤–æ–π –ª–∏–Ω–∏–µ–π
            if (gexChart) gexChart.destroy();
            const ctxGex = document.getElementById('gexChart').getContext('2d');
            gexChart = new Chart(ctxGex, {
                type: 'bar',
                data: {
                    labels: strikes,
                    datasets: [{
                        label: 'Net GEX',
                        data: gammaData,
                        backgroundColor: gammaData.map(v => 
                            v > 0 ? 'rgba(76, 175, 80, 0.8)' : 'rgba(244, 67, 54, 0.8)'
                        ),
                        borderColor: gammaData.map(v => 
                            v > 0 ? 'rgba(76, 175, 80, 1)' : 'rgba(244, 67, 54, 1)'
                        ),
                        borderWidth: 1,
                        barPercentage: 0.8,
                        categoryPercentage: 0.9
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: { mode: 'index', intersect: false },
                    plugins: { 
                        legend: { 
                            labels: { 
                                color: '#fff'
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `Net GEX: ${context.parsed.y.toFixed(2)}M`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                color: '#888', 
                                maxRotation: 45,
                                autoSkip: true,
                                maxTicksLimit: 15
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            offset: false
                        },
                        y: { 
                            ticks: { 
                                color: '#888',
                                callback: function(value) {
                                    return value + 'M';
                                }
                            }, 
                            grid: { 
                                color: function(context) {
                                    if (context.tick.value === 0) {
                                        return '#666';
                                    }
                                    return '#333';
                                },
                                drawBorder: false
                            },
                            beginAtZero: false
                        }
                    }
                }
            });

            // 8. Theta Decay
            const callTheta = data.map(r => (r.call?.theta || 0) * (r.call?.oi || 0) / 1000);
            const putTheta = data.map(r => (r.put?.theta || 0) * (r.put?.oi || 0) / 1000);

            if (thetaChart) thetaChart.destroy();
            const ctxTheta = document.getElementById('thetaChart').getContext('2d');
            thetaChart = new Chart(ctxTheta, {
                type: 'line',
                data: {
                    labels: strikes,
                    datasets: [{
                        label: 'Call Theta',
                        data: callTheta,
                        borderColor: '#4caf50',
                        backgroundColor: 'rgba(76, 175, 80, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 3
                    }, {
                        label: 'Put Theta',
                        data: putTheta,
                        borderColor: '#f44336',
                        backgroundColor: 'rgba(244, 67, 54, 0.1)',
                        borderWidth: 2,
                        fill: false,
                        tension: 0.4,
                        pointRadius: 0,
                        pointHoverRadius: 3
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            labels: { 
                                color: '#fff'
                            } 
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return `${context.dataset.label}: ${Math.abs(context.parsed.y).toFixed(1)}K`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: { 
                            ticks: { 
                                color: '#888', 
                                maxRotation: 45,
                                autoSkip: true,
                                maxTicksLimit: 15
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            offset: false
                        },
                        y: { 
                            ticks: { 
                                color: '#888',
                                callback: function(value) {
                                    return Math.abs(value) + 'K';
                                }
                            }, 
                            grid: { 
                                color: '#333',
                                drawBorder: false
                            },
                            beginAtZero: false,
                            title: {
                                display: true,
                                text: 'Theta Decay (K)',
                                color: '#888'
                            }
                        }
                    }
                }
            });
        }

        // ==========================================================================
        // üî• –†–ê–°–ß–ï–¢–´
        // ==========================================================================
        function calculateMaxPain(data) {
            if (!data || data.length === 0) return;
            
            const maxPainValues = {};
            
            data.forEach(strikeData => {
                const testStrike = parseFloat(strikeData.strike);
                let totalLoss = 0;
                
                data.forEach(s => {
                    const strike = parseFloat(s.strike);
                    const callOI = s.call?.oi || 0;
                    const putOI = s.put?.oi || 0;
                    
                    if (testStrike > strike) {
                        totalLoss += (testStrike - strike) * callOI * 100;
                    }
                    if (testStrike < strike) {
                        totalLoss += (strike - testStrike) * putOI * 100;
                    }
                });
                
                maxPainValues[testStrike] = totalLoss;
            });
            
            const maxPain = Object.keys(maxPainValues).reduce((a, b) => 
                maxPainValues[a] < maxPainValues[b] ? a : b
            );
            
            document.getElementById('max-pain-value').innerText = '$' + maxPain;
        }

        function calculatePCR(rows) {
            if (!rows || rows.length === 0) return;
            
            let totalPutOI = 0, totalCallOI = 0;
            let totalPutVol = 0, totalCallVol = 0;

            rows.forEach(r => {
                if(r.put) {
                    totalPutOI += (r.put.oi || 0);
                    totalPutVol += (r.put.vol || 0);
                }
                if(r.call) {
                    totalCallOI += (r.call.oi || 0);
                    totalCallVol += (r.call.vol || 0);
                }
            });
            
            let pcrOI = totalCallOI > 0 ? (totalPutOI / totalCallOI).toFixed(2) : "0.00";
            let pcrVol = totalCallVol > 0 ? (totalPutVol / totalCallVol).toFixed(2) : "0.00";
            
            document.getElementById('pcr-oi').innerText = pcrOI;
            document.getElementById('pcr-vol').innerText = pcrVol;
            
            colorPCR('pcr-oi', parseFloat(pcrOI));
            colorPCR('pcr-vol', parseFloat(pcrVol));
        }

        function colorPCR(elementId, value) {
            const el = document.getElementById(elementId);
            if(value > 1.0) el.style.color = "#f44336";
            else if(value < 0.7) el.style.color = "#4caf50";
            else el.style.color = "#fff";
        }

        // üî• –ì–†–ï–ö–ò
        function calculateGreeks(data) {
            if (!data || data.length === 0) return;
            
            let totalCallDelta = 0, totalPutDelta = 0;
            let totalGamma = 0, totalVega = 0, totalTheta = 0;
            let totalCallIV = 0, totalOI = 0;

            data.forEach(r => {
                const cOI = r.call?.oi || 0;
                const pOI = r.put?.oi || 0;
                totalCallDelta += (r.call?.delta || 0) * cOI;
                totalPutDelta += Math.abs(r.put?.delta || 0) * pOI;
                totalGamma += ((r.call?.gamma || 0) * cOI) + ((r.put?.gamma || 0) * pOI);
                totalVega += ((r.call?.vega || 0) * cOI) + ((r.put?.vega || 0) * pOI);
                totalTheta += ((r.call?.theta || 0) * cOI) + ((r.put?.theta || 0) * pOI);
                if(r.call?.iv > 0) { totalCallIV += r.call.iv * cOI; totalOI += cOI; }
            });

            document.getElementById('total-call-delta').innerText = (totalCallDelta / 1000).toFixed(0) + 'K';
            document.getElementById('total-put-delta').innerText = (totalPutDelta / 1000).toFixed(0) + 'K';
            document.getElementById('total-gamma').innerText = (totalGamma / 1000).toFixed(1) + 'K';
            document.getElementById('total-vega').innerText = (totalVega / 1000).toFixed(0) + 'K';
            document.getElementById('total-theta').innerText = (totalTheta / 1000).toFixed(0) + 'K';
            document.getElementById('avg-iv').innerText = totalOI > 0 ? (totalCallIV / totalOI).toFixed(1) + '%' : '0%';
            
            const skew = totalCallDelta - totalPutDelta;
            document.getElementById('delta-skew-value').innerText = (skew / 1000).toFixed(0) + 'K';
        }

        // ==========================================================================
        // üî• –ò–ù–¢–†–ê–î–ï–ô –ê–ù–ê–õ–ò–¢–ò–ö–ê (–û–ë–ù–û–í–õ–Ø–ï–¢–°–Ø –ò–ó SOCKET)
        // ==========================================================================
        function updateAnalytics(analytics) {
            if (!analytics) return;
            
            console.log('üìä –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏:', analytics);
            
            // Expected Move
            if (analytics.expected_move) {
                const move = parseFloat(analytics.expected_move);
                document.getElementById('exp-move-value').innerText = `¬±$${move.toFixed(2)}`;
                
                if (currentFuturesPrice > 0) {
                    const up = (currentFuturesPrice + move).toFixed(1);
                    const down = (currentFuturesPrice - move).toFixed(1);
                    document.getElementById('exp-move-range').innerText = `${down} ‚Äî ${up}`;
                }
            }
            
            // üî• ITM Probabilities - –î–ï–õ–ò–ú –ù–ê 100 –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (analytics.probabilities) {
                let callProb = analytics.probabilities.call_itm || 50;
                let putProb = analytics.probabilities.put_itm || 50;
                
                // –ï—Å–ª–∏ –∑–Ω–∞—á–µ–Ω–∏—è –±–æ–ª—å—à–µ 100, –¥–µ–ª–∏–º –Ω–∞ 100
                if (callProb > 100) callProb = callProb / 100;
                if (putProb > 100) putProb = putProb / 100;
                
                // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä—É–µ–º –¥–∏–∞–ø–∞–∑–æ–Ω
                const validCallProb = Math.max(0, Math.min(100, callProb));
                const validPutProb = Math.max(0, Math.min(100, putProb));
                
                document.getElementById('prob-call').innerText = validCallProb.toFixed(1) + '%';
                document.getElementById('prob-put').innerText = validPutProb.toFixed(1) + '%';
            } else {
                document.getElementById('prob-call').innerText = '50.0%';
                document.getElementById('prob-put').innerText = '50.0%';
            }
            
            // Advanced Greeks
            if (analytics.adv_metrics) {
                const color = analytics.adv_metrics.color || 0;
                const charm = analytics.adv_metrics.charm || 0;
                
                document.getElementById('metric-color').innerText = 
                    Math.abs(color) > 1000 ? (color / 1000).toFixed(2) + 'K' : color.toFixed(2);
                document.getElementById('metric-charm').innerText = 
                    Math.abs(charm) > 1000 ? (charm / 1000).toFixed(2) + 'K' : charm.toFixed(2);
            }
            
            // üî• Economic Calendar —Å –¥–∞—Ç–∞–º–∏
            if (analytics.calendar && Array.isArray(analytics.calendar)) {
                const calContainer = document.getElementById('calendar-list');
                const today = new Date().toLocaleDateString('ru-RU');
                
                calContainer.innerHTML = analytics.calendar.map(item => {
                    const eventDate = item.date || today;
                    const isToday = eventDate === today;
                    
                    return `
                        <div style="padding: 5px 0; border-bottom: 1px solid #333;">
                            <span style="color: ${isToday ? 'var(--accent-gold)' : '#888'}; font-weight: bold;">${item.time}</span>
                            <span style="color: #ccc; margin-left: 10px;">${item.event}</span>
                            <span style="color: #666; margin-left: 10px; font-size: 0.8em;">(${eventDate})</span>
                        </div>
                    `;
                }).join('');
            } else {
                const calContainer = document.getElementById('calendar-list');
                const today = new Date().toLocaleDateString('ru-RU');
                calContainer.innerHTML = `
                    <div style="color: #888; font-size: 0.9em; text-align: center;">
                        –î–∞–Ω–Ω—ã–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è...<br>
                        –ò—Å—Ç–æ—á–Ω–∏–∫: <a href="https://www.forexfactory.com/calendar" target="_blank" style="color: var(--accent-gold);">forexfactory.com</a>
                    </div>
                `;
            }

            // Zero Gamma
            if (analytics.zero_gamma && analytics.zero_gamma.strike !== undefined) {
                document.getElementById('zero-gamma-value').innerText = '$' + analytics.zero_gamma.strike;
                const pos = analytics.zero_gamma.position === 'above' ? 'üü¢ –í—ã—à–µ' : 'üî¥ –ù–∏–∂–µ';
                document.getElementById('zero-gamma-label').innerText = `–¶–µ–Ω–∞ ${pos} Zero Gamma`;
            }

            // Vanna
            if (analytics.vanna_exposure) {
                const vanna = analytics.vanna_exposure;
                document.getElementById('vanna-net').innerText = vanna.net_vanna.toFixed(0);
                document.getElementById('vanna-label').innerText = `Call: ${vanna.call_vanna.toFixed(0)} | Put: ${vanna.put_vanna.toFixed(0)}`;
            }

            // GEX Walls
            if (analytics.gex_profile) {
                let html = '';
                
                if (analytics.gex_profile.top_resistance && analytics.gex_profile.top_resistance.length > 0) {
                    html += '<div style="color: var(--call-color); font-weight: bold; margin-bottom: 5px;">üü¢ Resistance (Calls):</div>';
                    analytics.gex_profile.top_resistance.forEach(s => {
                        html += `<div class="level-item resistance">
                            <span>$${s.strike}</span>
                            <span style="color:#888; font-size: 0.9em;">${s.net_gex > 0 ? '+' : ''}${(s.net_gex/1000000).toFixed(1)}M</span>
                        </div>`;
                    });
                }

                if (analytics.gex_profile.top_support && analytics.gex_profile.top_support.length > 0) {
                    html += '<div style="color: var(--put-color); font-weight: bold; margin: 10px 0 5px 0;">üî¥ Support (Puts):</div>';
                    analytics.gex_profile.top_support.forEach(s => {
                        html += `<div class="level-item support">
                            <span>$${s.strike}</span>
                            <span style="color:#888; font-size: 0.9em;">${s.net_gex > 0 ? '+' : ''}${(s.net_gex/1000000).toFixed(1)}M</span>
                        </div>`;
                    });
                }
                
                if (html === '') {
                    html = '<div class="analytics-label">–ù–µ—Ç –∑–Ω–∞—á–∏–º—ã—Ö GEX —É—Ä–æ–≤–Ω–µ–π</div>';
                }
                
                document.getElementById('key-levels-display').innerHTML = html;
            }

            // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
            if (analytics.updated_at_utc) {
                document.getElementById('updated-time').innerText = analytics.updated_at_utc;
            }

            // Balance Price
            if (analytics.balance) {
                document.getElementById('balance-price').innerText = '$' + analytics.balance;
            }

            // Alerts
            generateAlerts(analytics);
        }

        function generateAlerts(analytics) {
            const container = document.getElementById('alerts-container');
            let alerts = [];

            // Zero Gamma Alert
            if (analytics.zero_gamma && analytics.zero_gamma.strike) {
                const distance = Math.abs(currentFuturesPrice - analytics.zero_gamma.strike);
                if (distance < 10) {
                    alerts.push({
                        type: 'warning',
                        text: `‚ö° –ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –∫ Zero Gamma: $${analytics.zero_gamma.strike} (${distance.toFixed(1)} away)`
                    });
                }
            }

            // GEX Walls Alert
            if (analytics.gex_profile) {
                const walls = [...(analytics.gex_profile.top_resistance || []), ...(analytics.gex_profile.top_support || [])];
                const nearWall = walls.find(w => w.distance < 5);
                
                if (nearWall) {
                    alerts.push({
                        type: 'info',
                        text: `üß± –ë–ª–∏–∑–∫–æ –∫ GEX Wall: $${nearWall.strike} (${nearWall.distance.toFixed(1)} away)`
                    });
                }
            }

            // High Vanna Alert
            if (analytics.vanna_exposure && Math.abs(analytics.vanna_exposure.net_vanna) > 10000) {
                const direction = analytics.vanna_exposure.net_vanna > 0 ? '–±—ã—á—å–µ–π' : '–º–µ–¥–≤–µ–∂—å–µ–π';
                alerts.push({
                    type: analytics.vanna_exposure.net_vanna > 0 ? 'info' : 'danger',
                    text: `üåÄ –í—ã—Å–æ–∫–æ–µ Vanna Exposure: ${Math.abs(analytics.vanna_exposure.net_vanna).toFixed(0)} (${direction})`
                });
            }

            // Render Alerts
            if (alerts.length === 0) {
                container.innerHTML = '<div class="alert alert-success">‚úÖ –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ —Ä—ã–Ω–æ—á–Ω—ã–µ —É—Å–ª–æ–≤–∏—è</div>';
            } else {
                container.innerHTML = alerts.map(a => 
                    `<div class="alert alert-${a.type}">${a.text}</div>`
                ).join('');
            }
        }

        // ==========================================================================
        // FORWARD & PREMIUM
        // ==========================================================================
        document.getElementById('forward-input').addEventListener('input', function(e) {
            const val = parseFloat(e.target.value);
            forwardCorrection = isNaN(val) ? 0 : val;
            if (cachedTableData.length > 0) {
                renderTable(cachedTableData);
                updateTop5(cachedTableData);
            }
        });

        document.getElementById('premium-toggle').addEventListener('click', function() {
            premiumEnabled = !premiumEnabled;
            this.textContent = premiumEnabled ? '–û—Ç–∫–ª. –ø—Ä–µ–º–∏–∏' : '–í–∫–ª. –ø—Ä–µ–º–∏–∏';
            this.classList.toggle('active');
            if (cachedTableData.length > 0) {
                renderTable(cachedTableData);
                updateTop5(cachedTableData);
            }
        });

        // EXPIRY TOGGLE
        document.querySelectorAll('.expiry-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.expiry-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                currentExpiry = this.dataset.expiry;
                
                const label = document.getElementById('table-expiry-label');
                label.innerText = currentExpiry === '0dte' ? 'INTRADAY' : 'FRIDAY';
                
                fetchHeavyData();
            });
        });

        // STRIKE FILTER
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', function() {
                document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                displayStrikeCount = parseInt(this.dataset.count);
                if (cachedTableData.length > 0) renderTable(cachedTableData);
            });
        });

        // ==========================================================================
        // üî• FETCH DATA
        // ==========================================================================
        async function fetchHeavyData() {
            try {
                const endpoint = currentExpiry === '0dte' ? 'gold_heavy2.json' : 'gold_friday.json';
                const url = `${DB_ROOT}/${endpoint}?t=${Date.now()}`;
                
                console.log(`üì° –ó–∞–≥—Ä—É–∑–∫–∞ –±–∞–∑—ã: ${url}`);
                const res = await fetch(url);
                const data = await res.json();
                
                if (!data || !data.data) return;

                // –°—Ä–∞–∑—É —Å—Ç–∞–≤–∏–º –≤—Ä–µ–º—è –∏ –±–∞–ª–∞–Ω—Å
                document.getElementById('updated-time').innerText = data.updated_at_utc || "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ...";
                if (data.balance_price) {
                    document.getElementById('balance-price').innerText = '$' + data.balance_price;
                    if (currentFuturesPrice === 0) currentFuturesPrice = parseFloat(data.balance_price);
                }

                // –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
                cachedTableData = Array.isArray(data.data) ? data.data : Object.values(data.data);

                // üî• –ú–ì–ù–û–í–ï–ù–ù–´–ô –õ–û–ö–ê–õ–¨–ù–´–ô –†–ê–°–ß–ï–¢
                calculatePCR(cachedTableData);
                calculateMaxPain(cachedTableData);
                calculateGreeks(cachedTableData);
                
                // –†–∞—Å—á–µ—Ç ITM –Ω–∞ –æ—Å–Ω–æ–≤–µ –î–µ–ª—å—Ç—ã (Delta ~ Probability)
                let atmStrike = cachedTableData.reduce((prev, curr) => 
                    Math.abs(parseFloat(curr.strike) - currentFuturesPrice) < Math.abs(parseFloat(prev.strike) - currentFuturesPrice) ? curr : prev
                );
                if (atmStrike) {
                    document.getElementById('prob-call').innerText = (Math.abs(atmStrike.call?.delta || 0.5) * 100).toFixed(1) + '%';
                    document.getElementById('prob-put').innerText = (Math.abs(atmStrike.put?.delta || 0.5) * 100).toFixed(1) + '%';
                }

                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞
                updateTop5(cachedTableData);
                renderTable(cachedTableData);
                setTimeout(() => createCharts(cachedTableData), 100);

            } catch (e) {
                console.error("–û—à–∏–±–∫–∞ Firebase:", e);
                document.getElementById('option-body').innerHTML = `<tr><td colspan="11" style="color:red">–û—à–∏–±–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</td></tr>`;
            }
        }

        // ==========================================================================
        // üî• TOP-5
        // ==========================================================================
        function updateTop5(rows) {
            if (!rows || rows.length === 0) return;
            
            const getTop = (arr, type, metric) => {
                return [...arr].sort((a, b) => (b[type]?.[metric] || 0) - (a[type]?.[metric] || 0)).slice(0, 5);
            };

            const render = (items, type, metric) => {
                return items.map(r => {
                    const s = parseFloat(r.strike) + forwardCorrection;
                    const val = r[type]?.[metric] || 0;
                    return `
                        <div class="top5-item ${type === 'call' ? 'call-item' : 'put-item'}">
                            <span class="top5-strike">${s.toFixed(1)}</span>
                            <span class="top5-value">${Math.round(val)}</span>
                        </div>`;
                }).join('');
            };

            document.getElementById('top5-call-vol').innerHTML = render(getTop(rows, 'call', 'vol'), 'call', 'vol');
            document.getElementById('top5-call-oi').innerHTML = render(getTop(rows, 'call', 'oi'), 'call', 'oi');
            document.getElementById('top5-put-vol').innerHTML = render(getTop(rows, 'put', 'vol'), 'put', 'vol');
            document.getElementById('top5-put-oi').innerHTML = render(getTop(rows, 'put', 'oi'), 'put', 'oi');
        }

        // ==========================================================================
        // üî• RENDER TABLE (–¶–ï–ù–¢–†–ò–†–û–í–ê–ù–ò–ï –ü–û –¶–ï–ù–ï)
        // ==========================================================================
        function renderTable(rows) {
            const tbody = document.getElementById('option-body');
            if (!tbody) return;
            tbody.innerHTML = '';
            
            if (!rows || rows.length === 0) return;

            // 1. –ü–æ–∏—Å–∫ –±–ª–∏–∂–∞–π—à–µ–≥–æ —Å—Ç—Ä–∞–π–∫–∞ –∫ —Ü–µ–Ω–µ –¥–ª—è —Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
            let closestIndex = 0;
            let minDiff = Infinity;
            
            const targetPrice = currentFuturesPrice > 0 ? currentFuturesPrice : 2600; 

            rows.forEach((row, idx) => {
                const strikeVal = parseFloat(row.strike) + forwardCorrection;
                const diff = Math.abs(strikeVal - targetPrice);
                if (diff < minDiff) {
                    minDiff = diff;
                    closestIndex = idx;
                }
            });

            // 2. –†–∞—Å—á–µ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–∞ –≤–∏–¥–∏–º–æ—Å—Ç–∏
            const halfRange = Math.floor(displayStrikeCount / 2);
            let startIdx = Math.max(0, closestIndex - halfRange);
            let endIdx = Math.min(rows.length, startIdx + displayStrikeCount);

            // –ö–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∫–∞ –µ—Å–ª–∏ —É–ø–µ—Ä–ª–∏—Å—å –≤ –∫–æ–Ω–µ—Ü –º–∞—Å—Å–∏–≤–∞
            if (endIdx - startIdx < displayStrikeCount) {
                startIdx = Math.max(0, endIdx - displayStrikeCount);
            }

            const displayRows = rows.slice(startIdx, endIdx);

            // 3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML
            displayRows.forEach((row, idx) => {
                const tr = document.createElement('tr');
                const rawStrike = parseFloat(row.strike) + forwardCorrection;
                const isATM = (startIdx + idx) === closestIndex;

                // –î–∞–Ω–Ω—ã–µ CALL
                const c_oi = row.call?.oi || 0;
                const c_vol = row.call?.vol || 0;
                const c_prem = row.call?.premium || 0;
                const c_delta = (row.call?.delta || 0).toFixed(3);
                const c_gamma = (row.call?.gamma || 0).toFixed(4);
                
                // –î–∞–Ω–Ω—ã–µ PUT
                const p_oi = row.put?.oi || 0;
                const p_vol = row.put?.vol || 0;
                const p_prem = row.put?.premium || 0;
                const p_delta = (row.put?.delta || 0).toFixed(3);
                const p_gamma = (row.put?.gamma || 0).toFixed(4);

                // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–π –∫–æ–ª–æ–Ω–∫–∏ (–°—Ç—Ä–∞–π–∫)
                let strikeHtml = '';
                if (premiumEnabled) {
                    strikeHtml = `
                        <div style="line-height:1.1;">
                            <span style="color:var(--call-color)">${(rawStrike + c_prem).toFixed(1)}</span><br>
                            <span style="color:var(--put-color); font-size:0.75em;">${(rawStrike - p_prem).toFixed(1)}</span>
                        </div>
                    `;
                } else {
                    strikeHtml = rawStrike.toFixed(1);
                }

                const strikeClass = forwardCorrection !== 0 ? 'col-strike forward-active' : 'col-strike';

                tr.innerHTML = `
                    <td class="${getValueClass(c_oi)}">${Math.round(c_oi)}</td>
                    <td class="${getValueClass(c_vol)}">${Math.round(c_vol)}</td>
                    <td style="color:#aaa;">${c_prem.toFixed(1)}</td>
                    <td style="color:var(--call-color);">${c_delta}</td>
                    <td style="color:#FFD700;">${c_gamma}</td>
                    
                    <td class="${strikeClass}">${strikeHtml}</td>
                    
                    <td style="color:#FFD700;">${p_gamma}</td>
                    <td style="color:var(--put-color);">${p_delta}</td>
                    <td style="color:#aaa;">${p_prem.toFixed(1)}</td>
                    <td class="${getValueClass(p_vol)}">${Math.round(p_vol)}</td>
                    <td class="${getValueClass(p_oi)}">${Math.round(p_oi)}</td>
                `;

                if (isATM) tr.classList.add('row-atm');
                tbody.appendChild(tr);
            });
        }

        // ==========================================================================
        // üî• –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
        // ==========================================================================
        
        // 1. –°–Ω–∞—á–∞–ª–∞ –∑–∞–ø—É—Å–∫–∞–µ–º WebSocket
        connectWebSocket();
        
        // 2. –°—Ä–∞–∑—É –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –∏–∑ Firebase
        fetchHeavyData();
        
        // 3. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (5 –º–∏–Ω—É—Ç)
        setInterval(fetchHeavyData, 300000);

    </script>
    </body>
</html>
